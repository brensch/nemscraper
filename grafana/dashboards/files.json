{
    "annotations": {
        "list": [
            {
                "builtIn": 1,
                "datasource": {
                    "type": "grafana",
                    "uid": "-- Grafana --"
                },
                "enable": true,
                "hide": true,
                "iconColor": "rgba(0, 211, 255, 1)",
                "name": "Annotations & Alerts",
                "type": "dashboard"
            }
        ]
    },
    "editable": true,
    "fiscalYearStartMonth": 0,
    "graphTooltip": 0,
    "id": 2,
    "links": [],
    "panels": [
        {
            "datasource": {
                "type": "motherduck-duckdb-datasource",
                "uid": "P18CE15CC9D3BAB28"
            },
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "thresholds"
                    },
                    "mappings": [],
                    "thresholds": {
                        "mode": "absolute",
                        "steps": [
                            {
                                "color": "red"
                            },
                            {
                                "color": "green",
                                "value": 1
                            }
                        ]
                    },
                    "unit": "percentunit"
                },
                "overrides": []
            },
            "gridPos": {
                "h": 5,
                "w": 6,
                "x": 0,
                "y": 0
            },
            "id": 7,
            "options": {
                "colorMode": "value",
                "graphMode": "area",
                "justifyMode": "auto",
                "orientation": "auto",
                "percentChangeColorMode": "standard",
                "reduceOptions": {
                    "calcs": [
                        "lastNotNull"
                    ],
                    "fields": "",
                    "values": false
                },
                "showPercentChange": false,
                "textMode": "auto",
                "wideLayout": true
            },
            "pluginVersion": "12.0.1",
            "targets": [
                {
                    "datasource": {
                        "type": "motherduck-duckdb-datasource",
                        "uid": "P18CE15CC9D3BAB28"
                    },
                    "editorMode": "code",
                    "format": 1,
                    "rawQuery": true,
                    "rawSql": "SELECT\r\n  CASE \r\n    WHEN total_downloaded = 0 THEN 0 \r\n    ELSE total_processed / total_downloaded \r\n  END AS percent_complete\r\nFROM (\r\n  SELECT\r\n    (SELECT count(*) \r\n     FROM read_parquet(\r\n       '/data/history/downloaded/date=*/**/*.parquet',\r\n       union_by_name => TRUE\r\n     )\r\n    )                     AS total_downloaded,\r\n    (SELECT count(*) \r\n     FROM read_parquet(\r\n       '/data/history/processed/date=*/**/*.parquet',\r\n       union_by_name => TRUE\r\n     )\r\n    )                     AS total_processed\r\n) AS counts;\r\n",
                    "refId": "A",
                    "sql": {
                        "columns": [
                            {
                                "parameters": [],
                                "type": "function"
                            }
                        ],
                        "groupBy": [
                            {
                                "property": {
                                    "type": "string"
                                },
                                "type": "groupBy"
                            }
                        ],
                        "limit": 50
                    }
                }
            ],
            "title": "Percent Processed",
            "type": "stat"
        },
        {
            "datasource": {
                "type": "motherduck-duckdb-datasource",
                "uid": "P18CE15CC9D3BAB28"
            },
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "thresholds"
                    },
                    "custom": {
                        "align": "auto",
                        "cellOptions": {
                            "type": "auto"
                        },
                        "inspect": false
                    },
                    "mappings": [],
                    "thresholds": {
                        "mode": "absolute",
                        "steps": [
                            {
                                "color": "green"
                            },
                            {
                                "color": "red",
                                "value": 80
                            }
                        ]
                    }
                },
                "overrides": []
            },
            "gridPos": {
                "h": 5,
                "w": 6,
                "x": 6,
                "y": 0
            },
            "id": 5,
            "options": {
                "cellHeight": "sm",
                "footer": {
                    "countRows": false,
                    "fields": "",
                    "reducer": [
                        "sum"
                    ],
                    "show": false
                },
                "showHeader": true
            },
            "pluginVersion": "12.0.1",
            "targets": [
                {
                    "editorMode": "code",
                    "format": 1,
                    "rawQuery": true,
                    "rawSql": "SELECT\n  'Downloaded' AS state,\n  COUNT(*) AS total_count\nFROM read_parquet('/data/history/downloaded/date=*/**/*.parquet', union_by_name = TRUE)\nUNION ALL\nSELECT\n  'Processed' AS state,\n  COUNT(*) AS total_count\nFROM read_parquet('/data/history/processed/date=*/**/*.parquet', union_by_name = TRUE)\nORDER BY state;",
                    "refId": "A",
                    "sql": {
                        "columns": [
                            {
                                "parameters": [],
                                "type": "function"
                            }
                        ],
                        "groupBy": [
                            {
                                "property": {
                                    "type": "string"
                                },
                                "type": "groupBy"
                            }
                        ],
                        "limit": 50
                    }
                }
            ],
            "title": "All-Time Totals",
            "type": "table"
        },
        {
            "datasource": {
                "type": "motherduck-duckdb-datasource",
                "uid": "P18CE15CC9D3BAB28"
            },
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "custom": {
                        "axisBorderShow": false,
                        "axisCenteredZero": false,
                        "axisColorMode": "text",
                        "axisLabel": "",
                        "axisPlacement": "auto",
                        "barAlignment": 0,
                        "barWidthFactor": 0.6,
                        "drawStyle": "line",
                        "fillOpacity": 0,
                        "gradientMode": "none",
                        "hideFrom": {
                            "legend": false,
                            "tooltip": false,
                            "viz": false
                        },
                        "insertNulls": false,
                        "lineInterpolation": "linear",
                        "lineWidth": 1,
                        "pointSize": 5,
                        "scaleDistribution": {
                            "type": "linear"
                        },
                        "showPoints": "auto",
                        "spanNulls": false,
                        "stacking": {
                            "group": "A",
                            "mode": "none"
                        },
                        "thresholdsStyle": {
                            "mode": "off"
                        }
                    },
                    "mappings": [],
                    "thresholds": {
                        "mode": "absolute",
                        "steps": [
                            {
                                "color": "green"
                            },
                            {
                                "color": "red",
                                "value": 80
                            }
                        ]
                    }
                },
                "overrides": []
            },
            "gridPos": {
                "h": 5,
                "w": 12,
                "x": 12,
                "y": 0
            },
            "id": 6,
            "options": {
                "legend": {
                    "calcs": [],
                    "displayMode": "list",
                    "placement": "bottom",
                    "showLegend": true
                },
                "tooltip": {
                    "hideZeros": false,
                    "mode": "single",
                    "sort": "none"
                }
            },
            "pluginVersion": "12.0.1",
            "targets": [
                {
                    "datasource": {
                        "type": "motherduck-duckdb-datasource",
                        "uid": "P18CE15CC9D3BAB28"
                    },
                    "editorMode": "code",
                    "format": 0,
                    "rawQuery": true,
                    "rawSql": "SELECT\r\n  time_bucket($__interval, download_end) AS time,\r\n  count(*) AS value,\r\n  'Downloaded' AS metric\r\nFROM read_parquet(\r\n  '/data/history/downloaded/date=*/**/*.parquet',\r\n  union_by_name = TRUE\r\n)\r\nWHERE $__timeFilter(download_end)\r\nGROUP BY 1\r\n\r\nUNION ALL\r\n\r\nSELECT\r\n  time_bucket($__interval, processing_end) AS time,\r\n  count(*) AS value,\r\n  'Processed' AS metric\r\nFROM read_parquet(\r\n  '/data/history/processed/date=*/**/*.parquet',\r\n  union_by_name = TRUE\r\n)\r\nWHERE $__timeFilter(processing_end)\r\nGROUP BY 1\r\n\r\nORDER BY 1,3;\r\n",
                    "refId": "A",
                    "sql": {
                        "columns": [
                            {
                                "parameters": [],
                                "type": "function"
                            }
                        ],
                        "groupBy": [
                            {
                                "property": {
                                    "type": "string"
                                },
                                "type": "groupBy"
                            }
                        ],
                        "limit": 50
                    }
                }
            ],
            "title": "Files",
            "type": "timeseries"
        },
        {
            "datasource": {
                "type": "motherduck-duckdb-datasource",
                "uid": "P18CE15CC9D3BAB28"
            },
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "custom": {
                        "axisBorderShow": false,
                        "axisCenteredZero": false,
                        "axisColorMode": "text",
                        "axisLabel": "",
                        "axisPlacement": "auto",
                        "barAlignment": 0,
                        "barWidthFactor": 0.6,
                        "drawStyle": "line",
                        "fillOpacity": 0,
                        "gradientMode": "none",
                        "hideFrom": {
                            "legend": false,
                            "tooltip": false,
                            "viz": false
                        },
                        "insertNulls": false,
                        "lineInterpolation": "linear",
                        "lineWidth": 1,
                        "pointSize": 5,
                        "scaleDistribution": {
                            "type": "linear"
                        },
                        "showPoints": "auto",
                        "spanNulls": false,
                        "stacking": {
                            "group": "A",
                            "mode": "none"
                        },
                        "thresholdsStyle": {
                            "mode": "off"
                        }
                    },
                    "mappings": [],
                    "thresholds": {
                        "mode": "absolute",
                        "steps": [
                            {
                                "color": "green"
                            },
                            {
                                "color": "red",
                                "value": 80
                            }
                        ]
                    },
                    "unit": "sishort"
                },
                "overrides": []
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 5
            },
            "id": 9,
            "options": {
                "legend": {
                    "calcs": [],
                    "displayMode": "list",
                    "placement": "bottom",
                    "showLegend": true
                },
                "tooltip": {
                    "hideZeros": false,
                    "mode": "single",
                    "sort": "none"
                }
            },
            "pluginVersion": "12.0.1",
            "targets": [
                {
                    "datasource": {
                        "type": "motherduck-duckdb-datasource",
                        "uid": "P18CE15CC9D3BAB28"
                    },
                    "editorMode": "code",
                    "format": 1,
                    "rawQuery": true,
                    "rawSql": "SELECT\r\n  time_bucket($__interval, processing_end) AS time,\r\n  CAST(SUM(total_rows) AS DOUBLE)       AS value\r\nFROM read_parquet(\r\n  '/data/history/processed/date=*/**/*.parquet',\r\n  union_by_name => TRUE\r\n)\r\nWHERE $__timeFilter(processing_end)\r\nGROUP BY 1\r\nORDER BY 1;\r\n",
                    "refId": "A",
                    "sql": {
                        "columns": [
                            {
                                "parameters": [],
                                "type": "function"
                            }
                        ],
                        "groupBy": [
                            {
                                "property": {
                                    "type": "string"
                                },
                                "type": "groupBy"
                            }
                        ],
                        "limit": 50
                    }
                }
            ],
            "title": "Data points Processed",
            "type": "timeseries"
        },
        {
            "datasource": {
                "type": "motherduck-duckdb-datasource",
                "uid": "P18CE15CC9D3BAB28"
            },
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "custom": {
                        "axisBorderShow": false,
                        "axisCenteredZero": false,
                        "axisColorMode": "text",
                        "axisLabel": "",
                        "axisPlacement": "auto",
                        "barAlignment": 0,
                        "barWidthFactor": 0.6,
                        "drawStyle": "line",
                        "fillOpacity": 0,
                        "gradientMode": "none",
                        "hideFrom": {
                            "legend": false,
                            "tooltip": false,
                            "viz": false
                        },
                        "insertNulls": false,
                        "lineInterpolation": "linear",
                        "lineWidth": 1,
                        "pointSize": 5,
                        "scaleDistribution": {
                            "type": "linear"
                        },
                        "showPoints": "auto",
                        "spanNulls": false,
                        "stacking": {
                            "group": "A",
                            "mode": "none"
                        },
                        "thresholdsStyle": {
                            "mode": "off"
                        }
                    },
                    "mappings": [],
                    "thresholds": {
                        "mode": "absolute",
                        "steps": [
                            {
                                "color": "green"
                            },
                            {
                                "color": "red",
                                "value": 80
                            }
                        ]
                    },
                    "unit": "decbytes"
                },
                "overrides": []
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 5
            },
            "id": 8,
            "options": {
                "legend": {
                    "calcs": [],
                    "displayMode": "list",
                    "placement": "bottom",
                    "showLegend": true
                },
                "tooltip": {
                    "hideZeros": false,
                    "mode": "single",
                    "sort": "none"
                }
            },
            "pluginVersion": "12.0.1",
            "targets": [
                {
                    "datasource": {
                        "type": "motherduck-duckdb-datasource",
                        "uid": "P18CE15CC9D3BAB28"
                    },
                    "editorMode": "code",
                    "format": 0,
                    "rawQuery": true,
                    "rawSql": "SELECT\r\n  time_bucket($__interval, download_end) AS time,\r\n  'Downloaded'                     AS metric,\r\n  CAST(SUM(size_bytes) AS DOUBLE)  AS value\r\nFROM read_parquet(\r\n  '/data/history/downloaded/date=*/**/*.parquet',\r\n  union_by_name => TRUE\r\n)\r\nWHERE $__timeFilter(download_end)\r\nGROUP BY 1\r\n\r\nUNION ALL\r\n\r\nSELECT\r\n  time_bucket($__interval, processing_end) AS time,\r\n  'Processed'                            AS metric,\r\n  CAST(SUM(size_bytes) AS DOUBLE)        AS value\r\nFROM read_parquet(\r\n  '/data/history/processed/date=*/**/*.parquet',\r\n  union_by_name => TRUE\r\n)\r\nWHERE $__timeFilter(processing_end)\r\nGROUP BY 1\r\n\r\nORDER BY time, metric;\r\n",
                    "refId": "A",
                    "sql": {
                        "columns": [
                            {
                                "parameters": [],
                                "type": "function"
                            }
                        ],
                        "groupBy": [
                            {
                                "property": {
                                    "type": "string"
                                },
                                "type": "groupBy"
                            }
                        ],
                        "limit": 50
                    }
                }
            ],
            "title": "Downloaded Input vs Processed Output",
            "type": "timeseries"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
            },
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "custom": {
                        "axisBorderShow": false,
                        "axisCenteredZero": false,
                        "axisColorMode": "text",
                        "axisLabel": "",
                        "axisPlacement": "auto",
                        "barAlignment": 0,
                        "barWidthFactor": 0.6,
                        "drawStyle": "line",
                        "fillOpacity": 0,
                        "gradientMode": "none",
                        "hideFrom": {
                            "legend": false,
                            "tooltip": false,
                            "viz": false
                        },
                        "insertNulls": false,
                        "lineInterpolation": "linear",
                        "lineWidth": 1,
                        "pointSize": 5,
                        "scaleDistribution": {
                            "type": "linear"
                        },
                        "showPoints": "auto",
                        "spanNulls": false,
                        "stacking": {
                            "group": "A",
                            "mode": "none"
                        },
                        "thresholdsStyle": {
                            "mode": "off"
                        }
                    },
                    "mappings": [],
                    "thresholds": {
                        "mode": "absolute",
                        "steps": [
                            {
                                "color": "green"
                            },
                            {
                                "color": "red",
                                "value": 80
                            }
                        ]
                    }
                },
                "overrides": []
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 0,
                "y": 13
            },
            "id": 10,
            "options": {
                "legend": {
                    "calcs": [],
                    "displayMode": "list",
                    "placement": "bottom",
                    "showLegend": true
                },
                "tooltip": {
                    "hideZeros": false,
                    "mode": "single",
                    "sort": "none"
                }
            },
            "pluginVersion": "12.0.1",
            "targets": [
                {
                    "datasource": {
                        "type": "prometheus",
                        "uid": "PBFA97CFB590B2093"
                    },
                    "editorMode": "code",
                    "expr": "100 * (\r\n  node_filesystem_size_bytes{fstype!~\"tmpfs|overlay|aufs|squashfs|devtmpfs\"}\r\n  -\r\n  node_filesystem_avail_bytes{fstype!~\"tmpfs|overlay|aufs|squashfs|devtmpfs\"}\r\n)\r\n/\r\nnode_filesystem_size_bytes{fstype!~\"tmpfs|overlay|aufs|squashfs|devtmpfs\"}\r\n",
                    "instant": false,
                    "legendFormat": "__auto",
                    "range": true,
                    "refId": "A"
                }
            ],
            "title": "File system utilisation (all mounts)",
            "type": "timeseries"
        },
        {
            "datasource": {
                "type": "prometheus",
                "uid": "PBFA97CFB590B2093"
            },
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "palette-classic"
                    },
                    "custom": {
                        "axisBorderShow": false,
                        "axisCenteredZero": false,
                        "axisColorMode": "text",
                        "axisLabel": "",
                        "axisPlacement": "auto",
                        "barAlignment": 0,
                        "barWidthFactor": 0.6,
                        "drawStyle": "line",
                        "fillOpacity": 0,
                        "gradientMode": "none",
                        "hideFrom": {
                            "legend": false,
                            "tooltip": false,
                            "viz": false
                        },
                        "insertNulls": false,
                        "lineInterpolation": "linear",
                        "lineWidth": 1,
                        "pointSize": 5,
                        "scaleDistribution": {
                            "type": "linear"
                        },
                        "showPoints": "auto",
                        "spanNulls": false,
                        "stacking": {
                            "group": "A",
                            "mode": "none"
                        },
                        "thresholdsStyle": {
                            "mode": "off"
                        }
                    },
                    "mappings": [],
                    "thresholds": {
                        "mode": "absolute",
                        "steps": [
                            {
                                "color": "green"
                            },
                            {
                                "color": "red",
                                "value": 80
                            }
                        ]
                    },
                    "unit": "decbytes"
                },
                "overrides": []
            },
            "gridPos": {
                "h": 8,
                "w": 12,
                "x": 12,
                "y": 13
            },
            "id": 11,
            "options": {
                "legend": {
                    "calcs": [],
                    "displayMode": "list",
                    "placement": "bottom",
                    "showLegend": true
                },
                "tooltip": {
                    "hideZeros": false,
                    "mode": "single",
                    "sort": "none"
                }
            },
            "pluginVersion": "12.0.1",
            "targets": [
                {
                    "datasource": {
                        "type": "prometheus",
                        "uid": "PBFA97CFB590B2093"
                    },
                    "editorMode": "code",
                    "expr": "assets_directory_size_bytes",
                    "instant": false,
                    "legendFormat": "__auto",
                    "range": true,
                    "refId": "A"
                }
            ],
            "title": "Asset Directory Size",
            "type": "timeseries"
        },
        {
            "datasource": {
                "type": "motherduck-duckdb-datasource",
                "uid": "P18CE15CC9D3BAB28"
            },
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "thresholds"
                    },
                    "custom": {
                        "axisPlacement": "auto",
                        "fillOpacity": 70,
                        "hideFrom": {
                            "legend": false,
                            "tooltip": false,
                            "viz": false
                        },
                        "insertNulls": false,
                        "lineWidth": 0,
                        "spanNulls": false
                    },
                    "mappings": [],
                    "thresholds": {
                        "mode": "absolute",
                        "steps": [
                            {
                                "color": "green"
                            },
                            {
                                "color": "red",
                                "value": 80
                            }
                        ]
                    }
                },
                "overrides": []
            },
            "gridPos": {
                "h": 8,
                "w": 24,
                "x": 0,
                "y": 21
            },
            "id": 13,
            "options": {
                "alignValue": "left",
                "legend": {
                    "displayMode": "list",
                    "placement": "bottom",
                    "showLegend": true
                },
                "mergeValues": true,
                "rowHeight": 0.9,
                "showValue": "auto",
                "tooltip": {
                    "hideZeros": false,
                    "mode": "single",
                    "sort": "none"
                }
            },
            "pluginVersion": "12.0.1",
            "targets": [
                {
                    "datasource": {
                        "type": "motherduck-duckdb-datasource",
                        "uid": "P18CE15CC9D3BAB28"
                    },
                    "editorMode": "code",
                    "format": 1,
                    "rawQuery": true,
                    "rawSql": "WITH downloads AS (\r\n  SELECT\r\n    download_start AS start_time,\r\n    download_end   AS end_time,\r\n    thread,\r\n    filename\r\n  FROM read_parquet(\r\n    '/data/history/downloaded/date=*/**/*.parquet',\r\n    union_by_name => TRUE\r\n  )\r\n  WHERE $__timeFilter(download_end)\r\n  ORDER BY download_end DESC\r\n)\r\nSELECT\r\n  start_time,\r\n  end_time,\r\n\r\n  MAX(filename) FILTER (WHERE thread = 0) AS thread_0,\r\n  MAX(filename) FILTER (WHERE thread = 1) AS thread_1,\r\n  MAX(filename) FILTER (WHERE thread = 2) AS thread_2\r\n\r\nFROM downloads\r\nGROUP BY start_time, end_time\r\nORDER BY start_time;\r\n",
                    "refId": "A",
                    "sql": {
                        "columns": [
                            {
                                "parameters": [],
                                "type": "function"
                            }
                        ],
                        "groupBy": [
                            {
                                "property": {
                                    "type": "string"
                                },
                                "type": "groupBy"
                            }
                        ],
                        "limit": 50
                    }
                }
            ],
            "title": "Downloads per thread",
            "type": "state-timeline"
        },
        {
            "datasource": {
                "type": "motherduck-duckdb-datasource",
                "uid": "P18CE15CC9D3BAB28"
            },
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "thresholds"
                    },
                    "custom": {
                        "axisPlacement": "auto",
                        "fillOpacity": 70,
                        "hideFrom": {
                            "legend": false,
                            "tooltip": false,
                            "viz": false
                        },
                        "insertNulls": false,
                        "lineWidth": 0,
                        "spanNulls": false
                    },
                    "mappings": [],
                    "thresholds": {
                        "mode": "absolute",
                        "steps": [
                            {
                                "color": "green"
                            },
                            {
                                "color": "red",
                                "value": 80
                            }
                        ]
                    }
                },
                "overrides": []
            },
            "gridPos": {
                "h": 24,
                "w": 24,
                "x": 0,
                "y": 29
            },
            "id": 14,
            "options": {
                "alignValue": "left",
                "legend": {
                    "displayMode": "list",
                    "placement": "bottom",
                    "showLegend": true
                },
                "mergeValues": true,
                "rowHeight": 0.9,
                "showValue": "auto",
                "tooltip": {
                    "hideZeros": false,
                    "mode": "single",
                    "sort": "none"
                }
            },
            "pluginVersion": "12.0.1",
            "targets": [
                {
                    "datasource": {
                        "type": "motherduck-duckdb-datasource",
                        "uid": "P18CE15CC9D3BAB28"
                    },
                    "editorMode": "code",
                    "format": 1,
                    "rawQuery": true,
                    "rawSql": "WITH proc AS (\r\n  SELECT\r\n    processing_start AS start_time,\r\n    processing_end   AS end_time,\r\n    thread,\r\n    filename\r\n  FROM read_parquet(\r\n    '/data/history/processed/date=*/**/*.parquet',\r\n    union_by_name => TRUE\r\n  )\r\n  WHERE $__timeFilter(processing_end)\r\n  ORDER BY processing_end DESC\r\n)\r\nSELECT\r\n  start_time,\r\n  end_time,\r\n\r\n  MAX(filename) FILTER (WHERE thread = 0)  AS thread_0,\r\n  MAX(filename) FILTER (WHERE thread = 1)  AS thread_1,\r\n  MAX(filename) FILTER (WHERE thread = 2)  AS thread_2,\r\n  MAX(filename) FILTER (WHERE thread = 3)  AS thread_3,\r\n  MAX(filename) FILTER (WHERE thread = 4)  AS thread_4,\r\n  MAX(filename) FILTER (WHERE thread = 5)  AS thread_5,\r\n  MAX(filename) FILTER (WHERE thread = 6)  AS thread_6,\r\n  MAX(filename) FILTER (WHERE thread = 7)  AS thread_7,\r\n  MAX(filename) FILTER (WHERE thread = 8)  AS thread_8,\r\n  MAX(filename) FILTER (WHERE thread = 9)  AS thread_9,\r\n  MAX(filename) FILTER (WHERE thread = 10) AS thread_10,\r\n  MAX(filename) FILTER (WHERE thread = 11) AS thread_11,\r\n  MAX(filename) FILTER (WHERE thread = 12) AS thread_12,\r\n  MAX(filename) FILTER (WHERE thread = 13) AS thread_13,\r\n  MAX(filename) FILTER (WHERE thread = 14) AS thread_14,\r\n  MAX(filename) FILTER (WHERE thread = 15) AS thread_15,\r\n  MAX(filename) FILTER (WHERE thread = 16) AS thread_16,\r\n  MAX(filename) FILTER (WHERE thread = 17) AS thread_17,\r\n  MAX(filename) FILTER (WHERE thread = 18) AS thread_18,\r\n  MAX(filename) FILTER (WHERE thread = 19) AS thread_19,\r\n  MAX(filename) FILTER (WHERE thread = 20) AS thread_20,\r\n  MAX(filename) FILTER (WHERE thread = 21) AS thread_21,\r\n  MAX(filename) FILTER (WHERE thread = 22) AS thread_22,\r\n  MAX(filename) FILTER (WHERE thread = 23) AS thread_23,\r\n  MAX(filename) FILTER (WHERE thread = 24) AS thread_24,\r\n  MAX(filename) FILTER (WHERE thread = 25) AS thread_25,\r\n  MAX(filename) FILTER (WHERE thread = 26) AS thread_26,\r\n  MAX(filename) FILTER (WHERE thread = 27) AS thread_27,\r\n  MAX(filename) FILTER (WHERE thread = 28) AS thread_28,\r\n  MAX(filename) FILTER (WHERE thread = 29) AS thread_29,\r\n  MAX(filename) FILTER (WHERE thread = 30) AS thread_30,\r\n  MAX(filename) FILTER (WHERE thread = 31) AS thread_31\r\n\r\nFROM proc\r\nGROUP BY start_time, end_time\r\nORDER BY start_time;\r\n",
                    "refId": "A",
                    "sql": {
                        "columns": [
                            {
                                "parameters": [],
                                "type": "function"
                            }
                        ],
                        "groupBy": [
                            {
                                "property": {
                                    "type": "string"
                                },
                                "type": "groupBy"
                            }
                        ],
                        "limit": 50
                    }
                }
            ],
            "title": "Processed Files per core",
            "type": "state-timeline"
        },
        {
            "datasource": {
                "type": "motherduck-duckdb-datasource",
                "uid": "P18CE15CC9D3BAB28"
            },
            "fieldConfig": {
                "defaults": {
                    "color": {
                        "mode": "thresholds"
                    },
                    "custom": {
                        "align": "auto",
                        "cellOptions": {
                            "type": "auto"
                        },
                        "inspect": false
                    },
                    "mappings": [],
                    "thresholds": {
                        "mode": "absolute",
                        "steps": [
                            {
                                "color": "green"
                            },
                            {
                                "color": "red",
                                "value": 80
                            }
                        ]
                    }
                },
                "overrides": [
                    {
                        "matcher": {
                            "id": "byName",
                            "options": "download_size_bytes"
                        },
                        "properties": [
                            {
                                "id": "unit",
                                "value": "decbytes"
                            }
                        ]
                    },
                    {
                        "matcher": {
                            "id": "byName",
                            "options": "processed_size_bytes"
                        },
                        "properties": [
                            {
                                "id": "unit",
                                "value": "decbytes"
                            }
                        ]
                    }
                ]
            },
            "gridPos": {
                "h": 11,
                "w": 24,
                "x": 0,
                "y": 53
            },
            "id": 12,
            "options": {
                "cellHeight": "sm",
                "footer": {
                    "countRows": false,
                    "fields": "",
                    "reducer": [
                        "sum"
                    ],
                    "show": false
                },
                "showHeader": true,
                "sortBy": [
                    {
                        "desc": true,
                        "displayName": "downloading_duration_seconds"
                    }
                ]
            },
            "pluginVersion": "12.0.1",
            "targets": [
                {
                    "datasource": {
                        "type": "motherduck-duckdb-datasource",
                        "uid": "P18CE15CC9D3BAB28"
                    },
                    "editorMode": "code",
                    "format": 1,
                    "rawQuery": true,
                    "rawSql": "SELECT\r\n  p.filename,\r\n  d.url,\r\n  d.download_start,\r\n  d.download_end,\r\n  p.processing_start,\r\n  p.processing_end,\r\n  d.size_bytes     AS download_size_bytes,\r\n  p.size_bytes     AS processed_size_bytes,\r\n  p.total_rows,\r\n  (DATEDIFF('microsecond', p.processing_start, p.processing_end) / 1e6) AS processing_duration_seconds,\r\n  (DATEDIFF('microsecond', d.download_start, d.download_end) / 1e6) AS downloading_duration_seconds\r\nFROM\r\n  read_parquet(\r\n    '/data/history/processed/date=*/**/*.parquet',\r\n    union_by_name => TRUE\r\n  ) AS p\r\nLEFT JOIN\r\n  read_parquet(\r\n    '/data/history/downloaded/date=*/**/*.parquet',\r\n    union_by_name => TRUE\r\n  ) AS d\r\n  ON p.filename = d.filename\r\nORDER BY\r\n  p.processing_end DESC;\r\n",
                    "refId": "A",
                    "sql": {
                        "columns": [
                            {
                                "parameters": [],
                                "type": "function"
                            }
                        ],
                        "groupBy": [
                            {
                                "property": {
                                    "type": "string"
                                },
                                "type": "groupBy"
                            }
                        ],
                        "limit": 50
                    }
                }
            ],
            "title": "Processed",
            "type": "table"
        }
    ],
    "preload": false,
    "refresh": "5s",
    "schemaVersion": 41,
    "tags": [],
    "templating": {
        "list": []
    },
    "time": {
        "from": "2025-06-02T09:09:39.730Z",
        "to": "2025-06-02T11:42:27.072Z"
    },
    "timepicker": {},
    "timezone": "browser",
    "title": "File Stats",
    "uid": "a78f110c-caac-4f47-96d3-5772ce7d2120",
    "version": 2
}